<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.greedy.waterfall.company.model.dao.CompanyMapper">
	<resultMap type="com.greedy.waterfall.company.model.dto.CompanyDTO" id="companyResultMap">
		<association property="dept" resultMap="deptResultMap"/>
		<association property="team" resultMap="teamResultMap"/>
		<association property="job" resultMap="jobResultMap"/>
	</resultMap>
	
	<resultMap type="com.greedy.waterfall.company.model.dto.DeptDTO" id="deptResultMap">
		<id property="code" column="DEPT_CODE"/>
		<result property="name" column="DEPT_NAME"/>
	</resultMap>
	
	<resultMap type="com.greedy.waterfall.company.model.dto.TeamDTO" id="teamResultMap">
		<id property="code" column="TEAM_CODE"/>
		<result property="name" column="TEAM_NAME"/>
		<result property="deptCode" column="DEPT_CODE"/>
	</resultMap>
	
	<resultMap type="com.greedy.waterfall.company.model.dto.JobDTO" id="jobResultMap">
		<id property="code" column="JOB_CODE"/>
		<result property="name" column="JOB_NAME"/>
		<result property="rank" column="JOB_RANK"/>
	</resultMap>
	
	<select id="findDept" resultMap="deptResultMap">
		SELECT
		       DEPT_CODE
		     , DEPT_NAME
		  FROM TBL_DEPT
	</select>
	
	<!-- 직급 조회 -->
	<select id="findJob" resultMap="jobResultMap">
		SELECT 
		       JOB_RANK
		     , JOB_NAME
		     , JOB_CODE
		  FROM TBL_JOB_TITLE
		 ORDER BY 1 ASC
	</select>
	
	<!-- 직급 생성 -->
	<insert id="insertJob" parameterType="com.greedy.waterfall.company.model.dto.JobDTO">
		INSERT
		  INTO TBL_JOB_TITLE A
		(
		  A.JOB_CODE
		, A.JOB_NAME
		, A.JOB_RANK
		)
		VALUES
		(
		  #{ code }
		, #{ name }
		, #{ rank }
		)
	</insert>
	
	<!-- 직급 상세 -->
	<select id="detailJob" resultMap="jobResultMap">
		SELECT
		       A.JOB_RANK
		     , A.JOB_NAME
		     , A.JOB_CODE
		  FROM TBL_JOB_TITLE A
		 WHERE A.JOB_CODE = #{ code }
	</select>
	
	<!-- 직급 수정 -->
	<update id="updateJob" parameterType="com.greedy.waterfall.company.model.dto.JobDTO">
		UPDATE
		       TBL_JOB_TITLE A
		   SET A.JOB_RANK = #{ rank }
		     , A.JOB_NAME = #{ name }
		 WHERE A.JOB_CODE = #{ code }
	</update>
	
	<!-- 직급 삭제 -->
	<delete id="deleteJob" parameterType="String">
		DELETE
		  FROM TBL_JOB_TITLE A
		 WHERE A.JOB_CODE = #{ code }
	</delete>
</mapper>